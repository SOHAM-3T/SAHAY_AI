{% extends 'base.html' %}

{% block title %}Upload Resume - AI-360 Career Mentor{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2 class="text-center mb-4">
            <i class="fas fa-upload"></i> Upload Your Resume
        </h2>
        <p class="text-center lead">Get started by uploading your resume to receive personalized career insights</p>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="upload-area" id="uploadArea">
            <i class="fas fa-cloud-upload-alt" style="font-size: 4rem; color: var(--primary-color); margin-bottom: 20px;"></i>
            <h4>Drag & Drop Your Resume</h4>
            <p class="text-muted">or click to browse files</p>
            <p class="small text-muted">Supported format: PDF</p>
            
            <form method="post" enctype="multipart/form-data" id="uploadForm">
                {% csrf_token %}
                <input type="file" name="resume" id="resumeFile" accept=".pdf" style="display: none;">
                <button type="button" class="btn btn-primary" onclick="document.getElementById('resumeFile').click()">
                    <i class="fas fa-folder-open"></i> Choose File
                </button>
            </form>
        </div>
        
        <div id="fileInfo" style="display: none;" class="mt-3">
            <div class="alert alert-info">
                <i class="fas fa-file-pdf"></i>
                <span id="fileName"></span>
                <button type="button" class="btn btn-success btn-sm ms-3" onclick="submitForm()">
                    <i class="fas fa-upload"></i> Upload & Analyze
                </button>
            </div>
        </div>
        
        <div id="uploadProgress" style="display: none;" class="mt-3">
            <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
            </div>
            <p class="text-center mt-2">Analyzing your resume...</p>
        </div>
    </div>
</div>

<!-- Features Preview -->
<div class="row mt-5">
    <div class="col-12">
        <h3 class="text-center mb-4">What You'll Get After Upload</h3>
    </div>
    
    <div class="col-md-4">
        <div class="feature-card text-center">
            <div class="feature-icon">
                <i class="fas fa-chart-pie"></i>
            </div>
            <h5>Skills Breakdown</h5>
            <p>See all your skills categorized and quantified</p>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="feature-card text-center">
            <div class="feature-icon">
                <i class="fas fa-project-diagram"></i>
            </div>
            <h5>Project Analysis</h5>
            <p>Get insights into your project portfolio</p>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="feature-card text-center">
            <div class="feature-icon">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h5>Education Summary</h5>
            <p>Review your educational background</p>
        </div>
    </div>
</div>

<!-- Sample Resume Data -->
<div class="row mt-4">
    <div class="col-12">
        <div class="feature-card">
            <h4 class="text-center mb-3">Sample Analysis Preview</h4>
            <div class="row">
                <div class="col-md-3 text-center">
                    <div class="stats-card">
                        <div class="stats-number">47</div>
                        <div>Skills</div>
                    </div>
                </div>
                <div class="col-md-3 text-center">
                    <div class="stats-card">
                        <div class="stats-number">16</div>
                        <div>Projects</div>
                    </div>
                </div>
                <div class="col-md-3 text-center">
                    <div class="stats-card">
                        <div class="stats-number">5</div>
                        <div>Education</div>
                    </div>
                </div>
                <div class="col-md-3 text-center">
                    <div class="stats-card">
                        <div class="stats-number">0</div>
                        <div>Experience</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Drag and drop functionality
const uploadArea = document.getElementById('uploadArea');
const fileInput = document.getElementById('resumeFile');
const fileInfo = document.getElementById('fileInfo');
const fileName = document.getElementById('fileName');
const uploadProgress = document.getElementById('uploadProgress');

// Prevent default drag behaviors
['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    uploadArea.addEventListener(eventName, preventDefaults, false);
    document.body.addEventListener(eventName, preventDefaults, false);
});

// Highlight drop area when item is dragged over it
['dragenter', 'dragover'].forEach(eventName => {
    uploadArea.addEventListener(eventName, highlight, false);
});

['dragleave', 'drop'].forEach(eventName => {
    uploadArea.addEventListener(eventName, unhighlight, false);
});

// Handle dropped files
uploadArea.addEventListener('drop', handleDrop, false);

function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
}

function highlight(e) {
    uploadArea.style.borderColor = 'var(--secondary-color)';
    uploadArea.style.background = 'rgba(118, 75, 162, 0.1)';
}

function unhighlight(e) {
    uploadArea.style.borderColor = 'var(--primary-color)';
    uploadArea.style.background = 'rgba(102, 126, 234, 0.05)';
}

function handleDrop(e) {
    const dt = e.dataTransfer;
    const files = dt.files;
    handleFiles(files);
}

function handleFiles(files) {
    if (files.length > 0) {
        const file = files[0];
        if (file.type === 'application/pdf') {
            fileInput.files = files;
            showFileInfo(file.name);
        } else {
            alert('Please upload a PDF file.');
        }
    }
}

// File input change
fileInput.addEventListener('change', function(e) {
    if (e.target.files.length > 0) {
        const file = e.target.files[0];
        showFileInfo(file.name);
    }
});

function showFileInfo(name) {
    fileName.textContent = name;
    fileInfo.style.display = 'block';
    uploadArea.style.display = 'none';
}

function submitForm() {
    uploadProgress.style.display = 'block';
    fileInfo.style.display = 'none';
    
    // Simulate progress
    const progressBar = document.querySelector('.progress-bar');
    let progress = 0;
    const interval = setInterval(() => {
        progress += 10;
        progressBar.style.width = progress + '%';
        if (progress >= 100) {
            clearInterval(interval);
            document.getElementById('uploadForm').submit();
        }
    }, 200);
}

// Click to upload
uploadArea.addEventListener('click', function() {
    fileInput.click();
});
</script>
{% endblock %} 